{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst KEY = '42589102-bb5462888a4e95731e5ef7933';\nexport async function imageSearch(query, pageNum) {\n  const queryParams = new URLSearchParams({\n    key: KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: false,\n    per_page: 15,\n    page: pageNum,\n  });\n\n  const response = await axios.get('', { params: queryParams });\n  return response.data;\n}\n","import iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { imageSearch } from './pixabay-api';\n\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('#form');\nconst loader = document.querySelector('div');\nconst gallery = document.querySelector('.gallery');\nconst btnMoreImages = document.querySelector('.load-more');\nconst btnMoreImages_loader = document.querySelector('span.load');\n\nlet pageNum;\nlet currentQuery;\nlet renderCount = 0;\n\nconst lightbox = new SimpleLightbox('.gallery>.item-gallery a', {\n  //* options */\n  backgroundColor: '#EF4040',\n  captionsData: `alt`,\n  captionDelay: 250,\n});\n\nform.addEventListener('submit', searchImages);\n\nfunction addImagesMarcup(\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads\n) {\n  let markupItem = `\n  <li class=\"item-gallery\">\n    <a class=\"load-link\" href=\"${largeImageURL}\">\n      <img class=\"load-image\" src=\"${webformatURL}\" width=\"360\" alt=\"${tags}\" title=\"${tags}\">\n    </a>\n    <ul class=\"load-list\">\n      <li>\n        <h2>Likes</h2>\n        <p>${likes}</p>\n      </li>\n      <li>\n        <h2>Views</h2>\n        <p>${views}</p>\n      </li>\n      <li>\n        <h2>Comments</h2>\n        <p>${comments}</p>\n      </li>\n      <li>\n        <h2>Downloads</h2>\n        <p>${downloads}</p>\n      </li>\n    </ul>\n  </li>\n`;\n  gallery.insertAdjacentHTML('beforeend', markupItem);\n\n  if (renderCount >= 1) {\n    const galleryItemHeight = document\n      .querySelector('.item-gallery')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n  }\n}\n\nfunction searchImages(event) {\n  event.preventDefault();\n\n  gallery.innerHTML = '';\n\n  renderCount = 0;\n\n  currentQuery = form.elements.input.value.trim();\n\n  form.elements.input.value = '';\n\n  if (currentQuery === '') {\n    iziToast.error({\n      title: 'Error',\n      message: `Please enter a search query.`,\n      backgroundColor: '#EF4040',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      progressBarColor: '#B51B1B',\n      position: 'topRight',\n    });\n\n    btnMoreImages.classList.add('is-hidden');\n\n    return;\n  }\n\n  btnMoreImages.classList.add('is-hidden');\n\n  loader.classList.add('spinner');\n\n  pageNum = 1;\n\n  imageSearch(currentQuery, pageNum)\n    .then(response => {\n      if (response.hits.length === 0) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n        throw new Error('No images found');\n      }\n      //відмальовую\n      response.hits.map(item =>\n        addImagesMarcup(\n          item.largeImageURL,\n          item.webformatURL,\n          item.tags,\n          item.likes,\n          item.views,\n          item.comments,\n          item.downloads\n        )\n      );\n\n      btnMoreImages.classList.remove('is-hidden');\n\n      lightbox.refresh();\n\n      renderCount++;\n    })\n    .catch(error => console.log(error))\n    .finally(() => {\n      loader.classList.remove('spinner');\n    });\n}\n\nbtnMoreImages.addEventListener('click', addMoreImages);\n\nasync function addMoreImages() {\n  //збільшую сторінку\n  pageNum++;\n\n  try {\n    btnMoreImages_loader.classList.remove('is-hidden');\n    const response = await imageSearch(currentQuery, pageNum);\n    //відмальовую\n    response.hits.map(item =>\n      addImagesMarcup(\n        item.largeImageURL,\n        item.webformatURL,\n        item.tags,\n        item.likes,\n        item.views,\n        item.comments,\n        item.downloads\n      )\n    );\n\n    lightbox.refresh();\n\n    const totalHits = response.totalHits || 0;\n    const totalPages = Math.ceil(totalHits / 15); // Розраховуємо загальну кількість сторінок\n\n    btnMoreImages_loader.classList.add('is-hidden');\n    if (pageNum >= totalPages) {\n      btnMoreImages.classList.add('is-hidden'); // Ховаємо кнопку \"Load More\", якщо це остання сторінка\n      iziToast.info({\n        title: 'Info',\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#4CAF50',\n        messageColor: '#fff',\n        titleColor: '#fff',\n        progressBarColor: '#4CAF50',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `${error.message || 'Something went wrong'}`,\n      backgroundColor: '#EF4040',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      progressBarColor: '#B51B1B',\n      position: 'topRight',\n    });\n  }\n}\n"],"names":["axios","KEY","imageSearch","query","pageNum","queryParams","form","loader","gallery","btnMoreImages","btnMoreImages_loader","currentQuery","renderCount","lightbox","SimpleLightbox","searchImages","addImagesMarcup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","markupItem","galleryItemHeight","event","iziToast","response","item","error","addMoreImages","totalHits","totalPages"],"mappings":"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"}